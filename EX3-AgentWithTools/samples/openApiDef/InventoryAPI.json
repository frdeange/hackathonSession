{
  "openapi": "3.0.1",
  "info": {
    "title": "Industrial Inventory Management API",
    "description": "Azure Function App - Industrial Inventory Management API.\n\nProvides HTTP endpoints for inventory and reservation management operations with CosmosDB integration: managing spare parts, checking stock levels, and creating reservations for industrial equipment and materials.",
    "version": "1.0.0",
    "contact": {
      "name": "Kiko de Angel",
      "email": "frdeange@microsoft.com"
    }
  },
  "servers": [
    {
      "url": "https://workshoptools-inventory-fwgnbma7g4d5bhbd.swedencentral-01.azurewebsites.net/api",
      "description": "Azure Functions base URL"
    }
  ],
  "tags": [
    {
      "name": "Health",
      "description": "Service health monitoring"
    },
    {
      "name": "Inventory",
      "description": "Inventory items and stock management"
    },
    {
      "name": "Reservations",
      "description": "Item reservation management"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": ["Health"],
        "operationId": "getHealth",
        "summary": "Health check",
        "description": "Returns the health status of the Inventory API service.",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthStatus"
                },
                "example": {
                  "status": "healthy",
                  "service": "inventory-api"
                }
              }
            }
          }
        }
      }
    },
    "/inventory": {
      "get": {
        "tags": ["Inventory"],
        "operationId": "getAllInventory",
        "summary": "Get all inventory items",
        "description": "Retrieve all items in the inventory with their current stock levels.",
        "responses": {
          "200": {
            "description": "Successfully retrieved inventory items",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/InventoryItem"
                  }
                },
                "example": [
                  {
                    "item_id": "PART-001",
                    "name": "Industrial Bearing SKF 6205",
                    "category": "bearings",
                    "stock_quantity": 45,
                    "location": "Warehouse A - Shelf 12",
                    "min_stock_level": 10,
                    "unit_price": 25.5,
                    "supplier": "SKF Industrial Supplies",
                    "last_updated": "2023-10-15T14:30:00.000000"
                  }
                ]
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/inventory/low-stock": {
      "get": {
        "tags": ["Inventory"],
        "operationId": "getLowStockItems",
        "summary": "Get items with low stock",
        "description": "Retrieve all items that are at or below their minimum stock level.",
        "responses": {
          "200": {
            "description": "Successfully retrieved low stock items",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/InventoryItem"
                  }
                },
                "example": [
                  {
                    "item_id": "PART-002",
                    "name": "Deep Groove Ball Bearing 6308",
                    "category": "bearings",
                    "stock_quantity": 8,
                    "min_stock_level": 15,
                    "location": "Warehouse A - Shelf 05",
                    "unit_price": 32.0,
                    "supplier": "SKF Industrial Supplies",
                    "last_updated": "2023-10-15T14:30:00.000000"
                  }
                ]
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/inventory/category/{category}": {
      "get": {
        "tags": ["Inventory"],
        "operationId": "getItemsByCategory",
        "summary": "Get items by category",
        "description": "Retrieve all items belonging to a specific category.",
        "parameters": [
          {
            "name": "category",
            "in": "path",
            "required": true,
            "description": "Category name (e.g. bearings, motors, sensors, filters, seals).",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved items in category",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/InventoryItem"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/inventory/{item_id}": {
      "get": {
        "tags": ["Inventory"],
        "operationId": "checkStock",
        "summary": "Check stock for a specific item",
        "description": "Check stock availability for a specific item by its ID.",
        "parameters": [
          {
            "name": "item_id",
            "in": "path",
            "required": true,
            "description": "Unique identifier of the inventory item.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved stock information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StockCheckResponse"
                },
                "example": {
                  "item_id": "PART-001",
                  "available": true,
                  "stock_quantity": 45,
                  "location": "Warehouse A - Shelf 12",
                  "estimated_delivery_days": null
                }
              }
            }
          },
          "404": {
            "description": "Item not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": "Item not found"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/inventory/reserve": {
      "post": {
        "tags": ["Inventory", "Reservations"],
        "operationId": "reserveItems",
        "summary": "Reserve items for maintenance",
        "description": "Reserve inventory items for scheduled maintenance work.\n\nValidates stock availability and creates a reservation document in CosmosDB.",
        "requestBody": {
          "required": true,
          "description": "Reservation request details.",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReservationRequest"
              },
              "example": {
                "item_id": "PART-001",
                "quantity": 5,
                "requested_by": "John Technician",
                "work_order": "WO-2023-1001"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully created reservation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReservationResponse"
                },
                "example": {
                  "reservation_id": "RES-20231001-001",
                  "item_id": "PART-001",
                  "quantity": 5,
                  "status": "confirmed",
                  "reserved_until": "2023-10-22T14:30:00.000000"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or insufficient stock",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "invalidBody": {
                    "summary": "Invalid request body",
                    "value": {
                      "error": "Invalid request body: <error details>"
                    }
                  },
                  "insufficientStock": {
                    "summary": "Insufficient stock",
                    "value": {
                      "error": "Insufficient stock. Available: 3, Requested: 5"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Item not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": "Item not found"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/reservations": {
      "get": {
        "tags": ["Reservations"],
        "operationId": "getAllReservations",
        "summary": "Get all active reservations",
        "description": "Retrieve all active item reservations.",
        "responses": {
          "200": {
            "description": "Successfully retrieved reservations",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ReservationResponse"
                  }
                },
                "example": [
                  {
                    "reservation_id": "RES-20231001-001",
                    "item_id": "PART-001",
                    "quantity": 5,
                    "status": "confirmed",
                    "reserved_until": "2023-10-22T14:30:00.000000"
                  }
                ]
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/reservations/{reservation_id}": {
      "get": {
        "tags": ["Reservations"],
        "operationId": "getReservation",
        "summary": "Get specific reservation",
        "description": "Retrieve details of a specific reservation.",
        "parameters": [
          {
            "name": "reservation_id",
            "in": "path",
            "required": true,
            "description": "Unique identifier of the reservation.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved reservation",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReservationResponse"
                },
                "example": {
                  "reservation_id": "RES-20231001-001",
                  "item_id": "PART-001",
                  "quantity": 5,
                  "status": "confirmed",
                  "reserved_until": "2023-10-22T14:30:00.000000"
                }
              }
            }
          },
          "404": {
            "description": "Reservation not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "error": "Reservation not found"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HealthStatus": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "example": "healthy"
          },
          "service": {
            "type": "string",
            "example": "inventory-api"
          }
        }
      },
      "InventoryItem": {
        "type": "object",
        "description": "Inventory item stored in CosmosDB.",
        "properties": {
          "item_id": {
            "type": "string",
            "description": "Unique identifier of the inventory item."
          },
          "name": {
            "type": "string",
            "description": "Human-readable name of the item."
          },
          "category": {
            "type": "string",
            "description": "Category of the item (bearings, motors, sensors, etc.)."
          },
          "stock_quantity": {
            "type": "integer",
            "format": "int32",
            "description": "Current quantity in stock."
          },
          "location": {
            "type": "string",
            "description": "Physical location of the item in the warehouse."
          },
          "min_stock_level": {
            "type": "integer",
            "format": "int32",
            "description": "Minimum desired stock level before triggering replenishment."
          },
          "unit_price": {
            "type": "number",
            "format": "double",
            "description": "Unit price of the item."
          },
          "supplier": {
            "type": "string",
            "description": "Supplier name."
          },
          "last_updated": {
            "type": "string",
            "format": "date-time",
            "description": "Last time the item record was updated."
          }
        },
        "required": [
          "item_id",
          "name",
          "category",
          "stock_quantity"
        ]
      },
      "StockCheckResponse": {
        "type": "object",
        "description": "Stock availability information for a specific item.",
        "properties": {
          "item_id": {
            "type": "string"
          },
          "available": {
            "type": "boolean",
            "description": "Indicates if the item has stock available (> 0)."
          },
          "stock_quantity": {
            "type": "integer",
            "format": "int32"
          },
          "location": {
            "type": "string",
            "nullable": true,
            "description": "Location where the item is available. Null if no stock."
          },
          "estimated_delivery_days": {
            "type": "integer",
            "format": "int32",
            "nullable": true,
            "description": "Estimated delivery days when no stock is available. Null otherwise."
          }
        },
        "required": [
          "item_id",
          "available",
          "stock_quantity"
        ]
      },
      "ReservationRequest": {
        "type": "object",
        "description": "Request to reserve inventory items for maintenance work.",
        "properties": {
          "item_id": {
            "type": "string",
            "description": "ID of the item to reserve."
          },
          "quantity": {
            "type": "integer",
            "format": "int32",
            "description": "Quantity to reserve."
          },
          "requested_by": {
            "type": "string",
            "description": "Person requesting the reservation."
          },
          "work_order": {
            "type": "string",
            "description": "Associated work order number."
          }
        },
        "required": [
          "item_id",
          "quantity",
          "requested_by",
          "work_order"
        ]
      },
      "ReservationResponse": {
        "type": "object",
        "description": "Reservation details and status.",
        "properties": {
          "reservation_id": {
            "type": "string",
            "description": "Unique identifier of the reservation."
          },
          "item_id": {
            "type": "string"
          },
          "quantity": {
            "type": "integer",
            "format": "int32"
          },
          "status": {
            "type": "string",
            "description": "Status of the reservation (e.g. confirmed)."
          },
          "reserved_until": {
            "type": "string",
            "format": "date-time",
            "description": "Date until which the reservation is valid."
          }
        },
        "required": [
          "reservation_id",
          "item_id",
          "quantity",
          "status",
          "reserved_until"
        ]
      },
      "ErrorResponse": {
        "type": "object",
        "description": "Error response with message.",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message."
          }
        },
        "required": [
          "error"
        ]
      }
    }
  }
}